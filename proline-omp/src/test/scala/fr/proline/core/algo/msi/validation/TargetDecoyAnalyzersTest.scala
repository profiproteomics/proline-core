package fr.proline.core.algo.msi.validation

import org.junit.Assert._
import org.junit.Ignore
import org.junit.Test
import org.scalatestplus.junit.JUnitSuite
import com.typesafe.scalalogging.StrictLogging
import fr.proline.core.algo.msi.filtering.pepmatch.{BHFilter, ScorePSMFilter}
import fr.proline.core.algo.msi.filtering.IPeptideMatchSorter
import fr.proline.core.algo.msi.validation.pepmatch.{TDPepMatchValidator, TDPepMatchValidatorWithFDROptimization}
import fr.proline.core.om.model.msi._
import fr.proline.core.util.generator.msi.ResultSetFakeGenerator
import org.junit.Before

import scala.collection.mutable.ArrayBuffer

@Test
class TargetDecoyAnalyzersTest extends JUnitSuite with StrictLogging {

  var fakePeptide = new Peptide(id = -1L, sequence = "MENHIR", ptms = Array.empty[LocatedPtm], calculatedMass = 1000.0)

  var rs: ResultSet = null
  var rsDecoy: ResultSet = null

  @Before
  def setUp() = {
    rs = new ResultSetFakeGenerator(nbPeps = 4, nbProts = 2).toResultSet()
    rsDecoy = new ResultSetFakeGenerator(nbPeps = 4, nbProts = 2).toResultSet()
    rs.decoyResultSet = Some(rsDecoy)
  }

  @Test
  def getCorrectBasicTDAnalyzer() = {
    val prop = new ResultSetProperties()
    prop.targetDecoyMode = Some("CONCATENATED")
    rs.properties = Some(prop)

    val tdAnalyzer = new TDAnalyzerBuilder(analyzer = TargetDecoyAnalyzers.BASIC).build(Some(rs))
    assertNotNull(tdAnalyzer)
    assertTrue(tdAnalyzer.isDefined)
    assertTrue(tdAnalyzer.get.isInstanceOf[BasicTDAnalyzer])

    val validator = new TDPepMatchValidatorWithFDROptimization(new ScorePSMFilter(), Some(0.01f))
    validator.validatePeptideMatches(rs, tdAnalyzer)

    ()
  }

  @Test
  def TDAnalyzerTest() = {

    val scores = Array(83.57714505f,80.76457991f,75.90327452f,67.31831758f,64.59177134f,60.11863034f,59.79592223f,59.02138205f,58.86706612f,58.48055772f,57.69717849f,57.30790565f,57.12502148f,56.68729479f,56.65534155f,56.33885464f,56.18215649f,53.51567507f,53.44937144f,53.43401685f,52.9343701f,52.62752333f,52.58365672f,52.20126809f,51.90227474f,51.87419128f,51.84572396f,51.76205182f,51.45395368f,51.23292848f,51.10739721f,51.09716885f,50.96125036f,50.44557365f,50.34899546f,50.09354442f,49.50096186f,49.21559609f,49.09651251f,49.02721558f,49.01424922f,48.90052367f,48.31159139f,48.05329869f,47.68584365f,47.65930181f,47.51714414f,46.90298477f,46.49074904f,46.11100223f,45.96440899f,45.87212804f,45.56732027f,45.52771218f,45.21998719f,45.12795476f,45.12408508f,45.04279393f,44.96680613f,44.87431209f,44.69967099f,44.57073718f,44.52266936f,44.43772768f,44.16532955f,44.08874564f,43.92995095f,43.73211868f,43.61464534f,43.58523843f,43.57873848f,43.56281552f,43.45023737f,43.40576237f,43.30642393f,43.18538821f,43.13309459f,43.10890549f,42.9149166f,42.40456984f,42.38201202f,42.33474337f,42.2070362f,41.96914954f,41.9311394f,41.89940987f,41.7967217f,41.67685599f,41.67100319f,41.66534786f,41.53779804f,41.06797404f,40.98569694f,40.87766293f,40.82062731f,40.78535567f,40.69944966f,40.55377369f,40.09115356f,39.94092317f,39.85565619f,39.80799342f,39.77942166f,39.48784066f,39.3962366f,39.38503108f,39.24401827f,39.20317148f,39.19510075f,39.01596269f,38.9498301f,38.90427305f,38.66909812f,38.63980227f,38.63167327f,38.53345337f,38.53254115f,38.47216118f,38.30536468f,38.17290753f,38.15191649f,38.14491573f,38.12102674f,38.11043831f,38.05488357f,37.91145564f,37.9051216f,37.8753888f,37.84488322f,37.81956848f,37.8098529f,37.73974667f,37.64769679f,37.63079498f,37.60090786f,37.58305921f,37.53312873f,37.52052391f,37.37039705f,37.33224098f,37.32268942f,37.23245309f,37.23201744f,37.22460221f,37.06244672f,37.02144043f,36.98409897f,36.9402937f,36.79285791f,36.71503215f,36.69554765f,36.67341634f,36.6353203f,36.46081387f,36.45442019f,36.2455264f,36.14597634f,36.12584823f,36.08944699f,36.05151717f,36.02287028f,35.91550862f,35.82135715f,35.80500956f,35.75084284f,35.74469795f,35.64907541f,35.64668722f,35.60351657f,35.59124832f,35.54414593f,35.50929415f,35.3130898f,35.29741187f,35.25691546f,35.25558184f,35.18571183f,35.17236253f,35.13405927f,35.12373093f,35.08046272f,35.06544431f,34.83993429f,34.83505567f,34.74350732f,34.61065236f,34.44814031f,34.25844776f,34.2311131f,34.20009041f,34.18879115f,34.15147291f,34.03988834f,34.00037001f,33.97098913f,33.96826804f,33.8121004f,33.75996028f,33.74436259f,33.64360411f,33.63876407f,33.63404497f,33.62539606f,33.61564089f,33.58998305f,33.55191286f,33.45490752f,33.43106859f,33.25658287f,33.20087887f,33.15548202f,33.068034f,32.94693443f,32.94211137f,32.93389198f,32.90859271f,32.89273598f,32.84536008f,32.75715814f,32.72991649f,32.64700567f,32.61552149f,32.58446972f,32.57992886f,32.5685624f,32.5501528f,32.48359172f,32.48156915f,32.41922109f,32.31779649f,32.22836862f,32.21399308f,32.18442887f,32.16449479f,32.15676389f,32.10003809f,32.04985795f,32.02596783f,31.97880619f,31.96971048f,31.94181743f,31.89220613f,31.8815316f,31.87751061f,31.84901749f,31.77433769f,31.77394657f,31.6545971f,31.64918996f,31.64849961f,31.54021888f,31.51787429f,31.51679378f,31.42546939f,31.3522217f,31.24823834f,31.10161424f,31.09113181f,31.07273813f,31.0572816f,31.0568987f,31.0254309f,30.93424514f,30.90386161f,30.82682132f,30.81534936f,30.80354916f,30.7824144f,30.75597018f,30.7510105f,30.74551396f,30.72568962f,30.65901396f,30.60873f,30.56273805f,30.5202282f,30.42725695f,30.38664325f,30.38294376f,30.34140072f,30.33667417f,30.33294365f,30.29843112f,30.28462688f,30.27736977f,30.15372132f,30.14910714f,29.97958102f,29.97308028f,29.94671784f,29.94100702f,29.93491622f,29.87809313f,29.8739547f,29.83760851f,29.83600905f,29.80417466f,29.73202222f,29.68231899f,29.67587666f,29.64098901f,29.62064851f,29.60604216f,29.54320178f,29.51643f,29.42934765f,29.37584512f,29.37479029f,29.3414437f,29.2650292f,29.26426137f,29.2513998f,29.23227f,29.20492851f,29.19547489f,29.1947262f,29.0920332f,29.05796071f,29.05712922f,29.05206712f,29.01468913f,28.9318006f,28.92681321f,28.91900652f,28.89523395f,28.84405785f,28.83470308f,28.81452504f,28.77515602f,28.74155809f,28.69039379f,28.68731108f,28.6495553f,28.64574802f,28.63332831f,28.59929137f,28.53043367f,28.50779719f,28.49904809f,28.47666383f,28.39738287f,28.38930385f,28.3469794f,28.30034796f,28.27487258f,28.24932971f,28.17295217f,28.16992138f,28.13380288f,28.08352219f,28.07153086f,28.04499404f,28.02060934f,28.0013979f,27.9788788f,27.97442975f,27.94066184f,27.90535486f,27.90004475f,27.8884744f,27.84546134f,27.78978048f,27.75492851f,27.74845244f,27.71624677f,27.70654872f,27.679799f,27.66169631f,27.56723505f,27.5637854f,27.56368989f,27.55886461f,27.50293212f,27.48403064f,27.41844037f,27.40093599f,27.39011332f,27.37136878f,27.28939238f,27.25491709f,27.23347312f,27.2141387f,27.20611909f,27.19364017f,27.15309133f,27.10074631f,27.09232213f,27.04089832f,27.04054666f,27.01998473f,26.97066493f,26.94157556f,26.91801665f,26.8796221f,26.86960582f,26.83983852f,26.8039766f,26.77419045f,26.71198733f,26.69493783f,26.67954423f,26.6397652f,26.5764093f,26.54708293f,26.54648269f,26.54605639f,26.50969112f,26.50557003f,26.50288317f,26.49899242f,26.49451242f,26.49315528f,26.3983082f,26.39463734f,26.37083992f,26.33186646f,26.31863971f,26.27377938f,26.24372155f,26.23290857f,26.23213654f,26.21122568f,26.19964258f,26.18403092f,26.17192124f,26.15588667f,26.14702193f,26.12223859f,26.11829577f,26.10711643f,26.0996417f,26.08792886f,26.07462828f,26.04066801f,26.03567957f,26.0096768f,25.99486637f,25.94364697f,25.94122018f,25.90246463f,25.89980869f,25.89943461f,25.83151525f,25.82768357f,25.77478085f,25.76208771f,25.73449127f,25.7018815f,25.64928396f,25.63734438f,25.60575576f,25.57225865f,25.5443903f,25.50340518f,25.50112549f,25.49293532f,25.49264732f,25.48343768f,25.47504534f,25.44634245f,25.44606787f,25.43875936f,25.42751338f,25.41064737f,25.37550229f,25.36974744f,25.36446529f,25.28247691f,25.24808223f,25.24060704f,25.23487404f,25.15593581f,25.13119381f,25.10812284f,25.08299591f,25.04073854f,24.9994194f,24.98495731f,24.96374986f,24.95813672f,24.94099732f,24.91417061f,24.88681396f,24.88008594f,24.87973452f,24.85676764f,24.85579318f,24.842754f,24.81513315f,24.74353378f,24.72498067f,24.70858497f,24.68988373f,24.65581336f,24.63364797f,24.61746895f,24.60036178f,24.59845485f,24.59769263f,24.57228227f,24.56314732f,24.55088746f,24.52596181f,24.4824818f,24.47546358f,24.44153935f,24.44081948f,24.43634913f,24.39296174f,24.36549759f,24.33988592f,24.33679425f,24.28523213f,24.27087891f,24.25666387f,24.22845547f,24.17431632f,24.16280189f,24.14595892f,24.13880143f,24.12029031f,24.12028526f,24.09067215f,24.07893978f,24.04132443f,24.01354847f,23.99322334f,23.97331773f,23.94237371f,23.91774744f,23.90050848f,23.87282669f,23.86221608f,23.85213145f,23.79337618f,23.7733522f,23.73601787f,23.7149286f,23.70983671f,23.655415f,23.6094095f,23.59871332f,23.58071617f,23.55176103f,23.53117181f,23.51565959f,23.50261148f,23.49637371f,23.47452404f,23.4683005f,23.45697764f,23.44723626f,23.44467528f,23.41518249f,23.41201626f,23.3962807f,23.38515146f,23.36770549f,23.35182625f,23.31417533f,23.3063906f,23.29504694f,23.27867217f,23.24966049f,23.24445907f,23.24128794f,23.23924944f,23.23403355f,23.21955073f,23.18665968f,23.18557035f,23.17400507f,23.16647518f,23.1264936f,23.09483895f,23.06938967f,23.05431662f,23.04263358f,23.03414157f,22.99851839f,22.97299862f,22.86840532f,22.86590806f,22.85275935f,22.84143917f,22.79312448f,22.79171973f,22.76751314f,22.74586875f,22.73958684f,22.73108762f,22.72798995f,22.72741936f,22.72533996f,22.72225747f,22.71214821f,22.68781045f,22.65208488f,22.63905528f,22.6296519f,22.62329277f,22.61881994f,22.61649139f,22.60458608f,22.59935073f,22.58577753f,22.57902748f,22.57524697f,22.56752393f,22.56540759f,22.55093991f,22.54375016f,22.53592525f,22.52828299f,22.52781302f,22.51967461f,22.50100145f,22.49166172f,22.48107873f,22.47599805f,22.43164506f,22.4265664f,22.42634305f,22.4099007f,22.40115495f,22.39492415f,22.30693198f,22.28904444f,22.28679323f,22.27135574f,22.23556033f,22.23532698f,22.22797264f,22.21628884f,22.20895952f,22.19338119f,22.19145053f,22.18610575f,22.18492571f,22.13639988f,22.13329971f,22.11629175f,22.07826259f,22.04189839f,22.02389544f,21.98895497f,21.98878837f,21.9879484f,21.97917508f,21.97127123f,21.95648246f,21.9160499f,21.90252326f,21.89557563f,21.86380017f,21.85495524f,21.84410251f,21.82295144f,21.81261198f,21.80251572f,21.78665922f,21.78069738f,21.76973548f,21.76901506f,21.7641081f,21.75588824f,21.74778558f,21.73604256f,21.72886268f,21.72662896f,21.72577178f,21.70250411f,21.68298164f,21.68235719f,21.65436852f,21.61236539f,21.59516943f,21.5920431f,21.55849677f,21.47852231f,21.43625512f,21.43111516f,21.40180571f,21.38871984f,21.3355603f,21.31610474f,21.29126703f,21.25435492f,21.25280696f,21.24089396f,21.2090118f,21.20700193f,21.18601656f,21.17866759f,21.16025804f,21.15506331f,21.14783997f,21.12204033f,21.10659093f,21.08023269f,21.06829748f,21.00697178f,20.99640997f,20.96818666f,20.95539577f,20.9533477f,20.93878696f,20.93739755f,20.9246373f,20.91787021f,20.91284061f,20.89717443f,20.89050033f,20.87410605f,20.82831992f,20.82700503f,20.82383974f,20.79772249f,20.73150434f,20.72359981f,20.70800977f,20.69546821f,20.66938911f,20.66590497f,20.60324087f,20.56694559f,20.56338957f,20.55839236f,20.53276787f,20.48809906f,20.48661679f,20.46656513f,20.45278807f,20.44508334f,20.39933715f,20.37104822f,20.31754433f,20.28626177f,20.28034945f,20.27728577f,20.26412259f,20.23750426f,20.23642846f,20.23282086f,20.20201846f,20.200557f,20.18151695f,20.18043261f,20.17614429f,20.16411681f,20.10873548f,20.10542244f,20.04988265f,20.02308581f,20.01827867f,20.00569184f,19.96731962f,19.95701149f,19.94837634f,19.90386657f,19.90297459f,19.89091557f,19.85027953f,19.84478458f,19.82078532f,19.81829349f,19.80304712f,19.8005996f,19.79308174f,19.77331542f,19.7469863f,19.73555788f,19.72009812f,19.71971695f,19.70928233f,19.69525508f,19.69079841f,19.68616659f,19.68587634f,19.67937765f,19.67631717f,19.66596831f,19.66060368f,19.63771342f,19.63370837f,19.62962673f,19.60358957f,19.56568395f,19.53131962f,19.52790849f,19.5121771f,19.49954773f,19.49903385f,19.46665559f,19.44566544f,19.42317724f,19.38842397f,19.36963588f,19.36873755f,19.35289211f,19.35041175f,19.33582903f,19.32138718f,19.31887043f,19.29481118f,19.29342985f,19.29143931f,19.21594786f,19.20407493f,19.20154445f,19.16923744f,19.14150258f,19.11521131f,19.08945893f,19.08413617f,19.07832626f,19.06703933f,19.01375091f,19.00803643f,18.99764719f,18.96287324f,18.93474256f,18.90485006f,18.90351287f,18.85342864f,18.85241213f,18.83945534f,18.80515352f,18.77713936f,18.77310131f,18.75187559f,18.68118954f,18.64920919f,18.61337516f,18.5929476f,18.57250756f,18.56801088f,18.56002393f,18.55209404f,18.5474048f,18.53367539f,18.52140118f,18.49245214f,18.48418272f,18.4820839f,18.47193958f,18.47055223f,18.45373172f,18.44170272f,18.43397574f,18.4166094f,18.41049684f,18.40746849f,18.40667987f,18.39016023f,18.38752707f,18.37643238f,18.37203067f,18.32850428f,18.32209227f,18.31554667f,18.30824888f,18.30820948f,18.29255923f,18.27360413f,18.27354965f,18.24566032f,18.23252667f,18.23157893f,18.22841154f,18.22755175f,18.21849061f,18.21774935f,18.19869918f,18.19761825f,18.15696823f,18.14838105f,18.13234041f,18.10017766f,18.07756719f,18.07723391f,18.07394655f,18.06898786f,18.06575465f,18.04917921f,18.04757885f,18.02943092f,18.0229644f,18.01078387f,17.97984895f,17.96671608f,17.9434613f,17.92219745f,17.92169806f,17.90723417f,17.90332327f,17.90224458f,17.89861396f,17.89565442f,17.88615475f,17.88417023f,17.8614556f,17.86119505f,17.85704416f,17.82065053f,17.81940922f,17.81289131f,17.78262833f,17.76296911f,17.76059895f,17.74917968f,17.74690317f,17.71835149f,17.71033619f,17.69720514f,17.65591482f,17.62231417f,17.61445402f,17.59819677f,17.59258905f,17.5905554f,17.550564f,17.54693539f,17.52641832f,17.52589936f,17.51486776f,17.48766457f,17.48622521f,17.48070282f,17.4782055f,17.47656736f,17.4700403f,17.46732768f,17.46307835f,17.46163089f,17.45412075f,17.40493897f,17.40471599f,17.40276374f,17.39623679f,17.39106163f,17.38407284f,17.38141222f,17.35761711f,17.33611383f,17.30356581f,17.27810554f,17.25995227f,17.25392501f,17.24304989f,17.20973299f,17.18616437f,17.17281332f,17.12774416f,17.10357046f,17.09969545f,17.09144064f,17.08443415f,17.08379858f,17.0828423f,17.07654452f,17.03699153f,17.03113913f,17.01264215f,17.01005943f,17.0075951f,17.00265593f,17.00042767f,16.98075495f,16.97719891f,16.96851795f,16.95719452f,16.94938816f,16.93548447f,16.93106266f,16.89502879f,16.89019825f,16.88676531f,16.88459823f,16.87561878f,16.873769f,16.84771917f,16.843969f,16.84375576f,16.84147322f,16.83768502f,16.82669234f,16.82017842f,16.81318261f,16.78150558f,16.77378125f,16.7595007f,16.73693157f,16.73585815f,16.68059721f,16.66361951f,16.65337383f,16.65282705f,16.63624902f,16.61832701f,16.59634339f,16.58166448f,16.57808184f,16.56953018f,16.55394206f,16.55100901f,16.51460087f,16.4970248f,16.48039898f,16.46333011f,16.46261803f,16.45468187f,16.45227938f,16.4505116f,16.41708584f,16.40781997f,16.38381992f,16.38281349f,16.38279132f,16.37015299f,16.36068031f,16.3588441f,16.35642212f,16.35150314f,16.33071956f,16.31940087f,16.31572925f,16.31286264f,16.30891963f,16.3086155f,16.30062904f,16.2993223f,16.26117943f,16.26024633f,16.23541506f,16.21839501f,16.20283807f,16.16473998f,16.1510112f,16.14512406f,16.1373697f,16.135159f,16.08338608f,16.04554904f,16.0361424f,16.02448176f,16.0207846f,16.00983275f,15.98742233f,15.97684411f,15.97011982f,15.95603007f,15.93936403f,15.93290734f,15.93116536f,15.90000896f,15.88295397f,15.88195519f,15.87899994f,15.87119663f,15.86834216f,15.86352032f,15.86135165f,15.86060413f,15.8441992f,15.84213048f,15.84126292f,15.84035641f,15.83576143f,15.82446952f,15.82248755f,15.82142104f,15.81882392f,15.81871873f,15.79909267f,15.79794636f,15.78089726f,15.77319766f,15.76840256f,15.7580956f,15.72999217f,15.72505147f,15.71462114f,15.70259053f,15.68564762f,15.68461184f,15.6517881f,15.63368303f,15.63346665f,15.6330298f,15.62845717f,15.61834739f,15.59523747f,15.59129909f,15.58577703f,15.5701494f,15.55617653f,15.554902f,15.54971952f,15.51948303f,15.50662064f,15.46285105f,15.44937969f,15.44937334f,15.44809929f,15.40913029f,15.40763016f,15.39293769f,15.37449707f,15.37036554f,15.36443522f,15.35042176f,15.3338286f,15.31854522f,15.28042685f,15.2748093f,15.27191885f,15.26329488f,15.25706661f,15.24903374f,15.24596205f,15.23486179f,15.20673293f,15.19599248f,15.17772609f,15.15460898f,15.14307708f,15.12601973f,15.11867972f,15.1038023f,15.08604678f,15.08176806f,15.04802871f,15.04605368f,15.04442977f,15.01618187f,15.0093199f,15.00929462f,14.99844316f,14.99283608f,14.99233584f,14.99097006f,14.98647449f,14.97755797f,14.96038503f,14.91040058f,14.9033148f,14.89454413f,14.8904711f,14.88619968f,14.88593734f,14.87274997f,14.86991343f,14.86899445f,14.85843858f,14.85425514f,14.81650793f,14.80940033f,14.80802396f,14.80644214f,14.80394473f,14.79231485f,14.79054201f,14.78567871f,14.78560056f,14.75647598f,14.74525699f,14.73208852f,14.71439329f,14.69989205f,14.69722502f,14.69476932f,14.69311726f,14.69258963f,14.68950198f,14.66979278f,14.66362352f,14.65498735f,14.65244801f,14.57671504f,14.55402216f,14.55289167f,14.53350098f,14.52234668f,14.51370943f,14.51010353f,14.50489456f,14.50191104f,14.49978036f,14.47876267f,14.46746014f,14.45979543f,14.44475439f,14.41057992f,14.40975229f,14.39588876f,14.39163614f,14.38083371f,14.37205808f,14.36928719f,14.36641491f,14.33863611f,14.3346995f,14.31201609f,14.26914219f,14.26489059f,14.26320301f,14.25635938f,14.25365737f,14.23353872f,14.22317941f,14.21160672f,14.18567283f,14.1639675f,14.13764821f,14.11988428f,14.0894749f,14.07871435f,14.06546463f,14.05339519f,14.05248713f,13.99533814f,13.99005034f,13.97994964f,13.97286004f,13.96916723f,13.96268357f,13.95891589f,13.94012145f,13.92762089f,13.90911698f,13.90611629f,13.904583f,13.89191239f,13.88882567f,13.88651101f,13.88247451f,13.88034873f,13.87021763f,13.8620139f,13.82615245f,13.82613086f,13.81132163f,13.80656849f,13.80380374f,13.79658131f,13.79572236f,13.77032132f,13.76964266f,13.74163584f,13.73058712f,13.71451285f,13.7099989f,13.69025095f,13.68054902f,13.67052178f,13.65112901f,13.64979153f,13.6385485f,13.62490014f,13.62204765f,13.59360816f,13.57274086f,13.55511433f,13.53580889f,13.5224827f,13.51793632f,13.50928584f,13.50467901f,13.50280168f,13.49114262f,13.4696237f,13.4384112f,13.42188852f,13.42046857f,13.41797702f,13.41194652f,13.4117989f,13.37097841f,13.36069603f,13.35471614f,13.35080357f,13.34229875f,13.31979931f,13.31824431f,13.30566664f,13.30425223f,13.30134616f,13.29266214f,13.28943007f,13.28074764f,13.2586557f,13.24382835f,13.2426723f,13.23917544f,13.23373811f,13.22884118f,13.22180435f,13.21566668f,13.17562844f,13.1682465f,13.15153314f,13.13815082f,13.13325938f,13.119671f,13.1174115f,13.10947295f,13.09877717f,13.09780013f,13.08039742f,13.06995095f,13.06986851f,13.03197337f,13.02207457f,13.01086805f,12.9993237f,12.99413518f,12.98468298f,12.97676829f,12.97076945f,12.9651751f,12.96308458f,12.94784086f,12.94540781f,12.93129954f,12.92848442f,12.90333976f,12.90186884f,12.89241322f,12.89162629f,12.88861134f,12.88356488f,12.86732917f,12.86146096f,12.85075011f,12.83148252f,12.82164211f,12.80615347f,12.80069302f,12.74969752f,12.74161223f,12.72536236f,12.71293703f,12.69898758f,12.69828016f,12.66471436f,12.66409282f,12.64212641f,12.62190754f,12.61964114f,12.61309963f,12.5873678f,12.57489984f,12.57087762f,12.56024084f,12.54548936f,12.5219927f,12.52023109f,12.51305844f,12.50891641f,12.50583455f,12.49792569f,12.48651813f,12.48391844f,12.47285797f,12.43709777f,12.42909672f,12.39921283f,12.38221664f,12.35823218f,12.34960913f,12.32887535f,12.31278066f,12.29480732f,12.26827187f,12.26679548f,12.26288691f,12.25399449f,12.24953763f,12.24857803f,12.24081675f,12.23475071f,12.21575723f,12.21383179f,12.20951922f,12.20921217f,12.17996175f,12.17517296f,12.16162568f,12.14773752f,12.14596274f,12.14569385f,12.13502699f,12.12488983f,12.09710003f,12.07036772f,12.04451261f,12.04070757f,12.03561987f,12.03097028f,12.01790966f,12.00661981f,11.99017567f,11.9883718f,11.93587208f,11.92651126f,11.92298138f,11.91054926f,11.89360395f,11.89304701f,11.89079599f,11.86971606f,11.84094809f,11.82813959f,11.80600505f,11.78782325f,11.77712417f,11.77049609f,11.7571999f,11.75371157f,11.74735743f,11.74125782f,11.73666953f,11.72441818f,11.71720428f,11.71280988f,11.69967894f,11.69875171f,11.68329973f,11.67712285f,11.67269379f,11.66101109f,11.65640746f,11.65339488f,11.65281534f,11.63995155f,11.63415276f,11.62360709f,11.61840639f,11.61828564f,11.60420137f,11.60027004f,11.59862054f,11.59515837f,11.58770142f,11.55995174f,11.55869939f,11.55723596f,11.53298274f,11.5237106f,11.48813912f,11.47631284f,11.45407041f,11.44463984f,11.4364889f,11.43307895f,11.4137058f,11.40876546f,11.39106223f,11.39006464f,11.38715783f,11.37279564f,11.36515194f,11.34801955f,11.33773542f,11.32252785f,11.30474522f,11.29586054f,11.29004059f,11.28245144f,11.28168443f,11.24776606f,11.22683186f,11.22523309f,11.21834345f,11.19721904f,11.18519858f,11.15941881f,11.14108992f,11.14091854f,11.11759675f,11.10564573f,11.0999752f,11.0886245f,11.08342877f,11.05909933f,11.03773292f,11.01838583f,11.01240418f,11.00356961f,10.99655214f,10.99212812f,10.99135781f,10.96595904f,10.96042687f,10.94974225f,10.93468548f,10.91406343f,10.86690721f,10.85950377f,10.85829449f,10.81916614f,10.81025046f,10.79371446f,10.79334558f,10.75952259f,10.73309432f,10.73197365f,10.70812136f,10.68296556f,10.65136495f,10.63488404f,10.59119626f,10.57859753f,10.56900112f,10.55758496f,10.5335129f,10.51775605f,10.51400569f,10.48215564f,10.45459051f,10.44823518f,10.43495915f,10.42779248f,10.42588687f,10.40436083f,10.3975915f,10.39407723f,10.38521255f,10.38266248f,10.38111777f,10.33541658f,10.33518668f,10.3334026f,10.32760298f,10.32651316f,10.32369137f,10.28561755f,10.28197776f,10.28058407f,10.27600623f,10.24807547f,10.21569879f,10.19824735f,10.16539173f,10.16326413f,10.15486653f,10.14773756f,10.1130259f,10.10654217f,10.10154486f,10.06145016f,10.04687226f,10.04186436f,10.0301932f,9.968619116f,9.962267799f,9.959503646f,9.957250815f,9.956928396f,9.911055851f,9.907378895f,9.852477929f,9.790683636f,9.778179871f,9.756869821f,9.733070758f,9.729783813f,9.72907731f,9.722239639f,9.717964959f,9.717124989f,9.711573207f,9.709104683f,9.68463842f,9.674086134f,9.648731553f,9.645253398f,9.643553664f,9.634951986f,9.626127194f,9.612577556f,9.608473909f,9.605055689f,9.597549817f,9.59480991f,9.592195205f,9.573611521f,9.569226171f,9.536567123f,9.520701664f,9.506159858f,9.490449962f,9.486476127f,9.479933141f,9.463822741f,9.460297235f,9.45987779f,9.433879775f,9.411214321f,9.396396648f,9.360705367f,9.333769817f,9.321071807f,9.305578817f,9.273791472f,9.25573497f,9.227404362f,9.192235493f,9.185593994f,9.17822049f,9.172577067f,9.167026031f,9.122787024f,9.10539168f,9.058181214f,9.047704311f,9.038620604f,9.037195191f,9.033534631f,9.019765258f,9.012131005f,9.005793012f,8.99966928f,8.991628532f,8.989900124f,8.971352284f,8.95119418f,8.947822984f,8.945962083f,8.89609075f,8.875508946f,8.863123783f,8.860332202f,8.859263565f,8.855307464f,8.823293203f,8.813055596f,8.811882741f,8.809121697f,8.806591608f,8.800421078f,8.747420364f,8.73626664f,8.705507127f,8.703086394f,8.62090208f,8.598112254f,8.577897343f,8.576960071f,8.566116915f,8.549374495f,8.541503792f,8.492882692f,8.488390186f,8.485263119f,8.482729054f,8.475840269f,8.466827936f,8.462454948f,8.420641732f,8.415934119f,8.414447048f,8.40148977f,8.379368402f,8.36257841f,8.3527348f,8.332744817f,8.314036199f,8.312500561f,8.292429159f,8.281854647f,8.274728987f,8.272896626f,8.256634759f,8.251671854f,8.244512379f,8.238820652f,8.228773715f,8.196624949f,8.178464579f,8.173347316f,8.154881865f,8.153067096f,8.116112179f,8.111698722f,8.108509518f,8.102612118f,8.097790292f,8.090261367f,8.048841414f,8.044290866f,8.043382429f,8.042632278f,8.040732584f,8.027891811f,8.018903228f,7.971754264f,7.968865857f,7.962795309f,7.95487654f,7.953444528f,7.9488895f,7.941802109f,7.923771304f,7.879608666f,7.844210461f,7.835420599f,7.828311717f,7.819439593f,7.779520045f,7.76452193f,7.763465454f,7.745790577f,7.727960075f,7.723265384f,7.717585092f,7.677116851f,7.673310506f,7.672731116f,7.66580686f,7.661264493f,7.651843846f,7.622968397f,7.620509609f,7.619613201f,7.618936506f,7.614339219f,7.61346568f,7.602313702f,7.593938368f,7.59305687f,7.58806915f,7.584401218f,7.575687751f,7.571675616f,7.571168069f,7.544838684f,7.540446175f,7.516002807f,7.508582724f,7.501442574f,7.498183464f,7.49700235f,7.494258935f,7.477671123f,7.471957475f,7.450455269f,7.442389723f,7.43767603f,7.422902395f,7.420610572f,7.379099696f,7.376845881f,7.376289715f,7.369964803f,7.330095732f,7.324042029f,7.319956496f,7.310615277f,7.309702756f,7.299166932f,7.286488038f,7.277451621f,7.273961849f,7.247757328f,7.240159432f,7.237290622f,7.230817226f,7.213492139f,7.211976103f,7.196509498f,7.162058773f,7.157779896f,7.157373523f,7.133844882f,7.127503375f,7.125598314f,7.119290212f,7.093644809f,7.074787136f,7.071195527f,7.070308534f,7.054248866f,7.03836936f,7.018348854f,7.015254163f,6.99572021f,6.986574862f,6.948545781f,6.944006531f,6.937140921f,6.932589488f,6.930101636f,6.881504206f,6.866909008f,6.865735207f,6.861820701f,6.857661754f,6.836405035f,6.832332609f,6.828631735f,6.81457573f,6.809867961f,6.773524258f,6.763400357f,6.749234586f,6.74560668f,6.745175836f,6.723017583f,6.703379495f,6.683100501f,6.680316439f,6.676338094f,6.661043474f,6.65321003f,6.619252675f,6.579435519f,6.573638808f,6.568575846f,6.532904565f,6.519485889f,6.5046563f,6.500818611f,6.493600236f,6.486202703f,6.473529602f,6.469636994f,6.462614546f,6.454825904f,6.428420116f,6.387168917f,6.385507913f,6.355286302f,6.354699873f,6.353332456f,6.352744636f,6.324822242f,6.323985103f,6.31486899f,6.310467786f,6.310267102f,6.277483184f,6.272753983f,6.269368931f,6.262803676f,6.250659733f,6.243660856f,6.227799039f,6.214793889f,6.213117431f,6.202692492f,6.189517574f,6.182439125f,6.181828923f,6.172755857f,6.163087352f,6.153633797f,6.153509232f,6.151427735f,6.134041421f,6.129254721f,6.121250754f,6.111661402f,6.091250703f,6.090359418f,6.087108381f,6.064046166f,6.062669528f,6.061847816f,6.059962889f,6.052242166f,6.031761304f,6.026260142f,6.023123493f,6.015442391f,5.95948089f,5.958766797f,5.937932089f,5.928621206f,5.921232753f,5.899958126f,5.892818975f,5.889495101f,5.882664478f,5.876531383f,5.872024641f,5.87077079f,5.864559822f,5.861717765f,5.827990032f,5.817393834f,5.806447019f,5.801160555f,5.789537731f,5.76529077f,5.763044023f,5.758500142f,5.754667669f,5.753484359f,5.74078798f,5.728403967f,5.726398806f,5.70659025f,5.703744042f,5.698619826f,5.674689033f,5.658922246f,5.657615609f,5.654496218f,5.64783811f,5.631998279f,5.628671502f,5.618927095f,5.612877383f,5.606873967f,5.598683051f,5.549727963f,5.518162324f,5.502036438f,5.494043313f,5.483632156f,5.463814749f,5.462206596f,5.453191099f,5.448293021f,5.438565435f,5.434063285f,5.431994321f,5.430631854f,5.429533669f,5.403400576f,5.401025637f,5.400901707f,5.39761935f,5.371603909f,5.360443713f,5.358286368f,5.354628476f,5.347525129f,5.339724725f,5.331559246f,5.326347549f,5.322860925f,5.310943187f,5.290309307f,5.287287641f,5.28124266f,5.279833884f,5.250078555f,5.242747135f,5.240738745f,5.240171402f,5.233233239f,5.231865552f,5.214672456f,5.200569585f,5.170706167f,5.167599761f,5.137424097f,5.131876049f,5.125867682f,5.098995664f,5.091195888f,5.090317931f,5.066446866f,5.058995006f,5.054177655f,5.050896925f,5.05042922f,5.049907409f,5.034825547f,5.023153292f,5.022151554f,5.015097962f,5.012950146f,5.012099921f,5.003734703f,4.975831149f,4.968491577f,4.967052811f,4.960132437f,4.950789672f,4.946525571f,4.943761635f,4.94076756f,4.926836476f,4.926355891f,4.925562556f,4.912821465f,4.909410662f,4.895814888f,4.885516839f,4.883829856f,4.881004028f,4.868551608f,4.863578162f,4.837836199f,4.825868535f,4.813380511f,4.78816921f,4.771160269f,4.76935649f,4.748866498f,4.748224632f,4.747120694f,4.734649603f,4.717524947f,4.696454614f,4.686874618f,4.677904905f,4.675945655f,4.675351718f,4.663398915f,4.65560636f,4.647436813f,4.646880656f,4.643247553f,4.635618625f,4.630045742f,4.629237065f,4.624679205f,4.62215365f,4.61873076f,4.6079517f,4.599185399f,4.59761076f,4.591373921f,4.583653617f,4.58288066f,4.572934895f,4.569585481f,4.561468038f,4.560100151f,4.551205054f,4.549555991f,4.530060432f,4.520632404f,4.517400556f,4.497084412f,4.491281967f,4.489964791f,4.487815734f,4.487005185f,4.483302957f,4.460967801f,4.458483404f,4.456622088f,4.444713981f,4.436650035f,4.435608157f,4.414373897f,4.410518842f,4.387085106f,4.373590124f,4.359784718f,4.334143327f,4.333367962f,4.331161762f,4.322607494f,4.319893676f,4.303486159f,4.292822033f,4.287238235f,4.284562615f,4.268956964f,4.267443387f,4.259639075f,4.250229679f,4.250118925f,4.248414519f,4.24507022f,4.229562192f,4.21979628f,4.218306331f,4.216262176f,4.214197939f,4.207766611f,4.191223908f,4.190663445f,4.19011206f,4.182400572f,4.179351336f,4.175416219f,4.175067289f,4.136080383f,4.123094767f,4.109912678f,4.107330236f,4.104808484f,4.103318496f,4.102133377f,4.101036915f,4.099265851f,4.091953954f,4.091003531f,4.08496879f,4.080968724f,4.077517131f,4.074541285f,4.060941154f,4.059933287f,4.053168706f,4.04677364f,4.041804394f,4.038532034f,4.037542229f,4.036488664f,4.025104123f,3.998241707f,3.992430807f,3.984616388f,3.981438512f,3.969962578f,3.962624399f,3.947125223f,3.94615944f,3.932921652f,3.929396307f,3.929315678f,3.909407876f,3.895155911f,3.892381689f,3.892117724f,3.873737878f,3.871355635f,3.870333846f,3.854003102f,3.844119919f,3.843877424f,3.837161933f,3.829844846f,3.825061046f,3.822823245f,3.816287756f,3.808856274f,3.808846182f,3.800103563f,3.797901755f,3.796858141f,3.788833433f,3.776877957f,3.746935986f,3.736098666f,3.723313699f,3.720301632f,3.703166124f,3.702539477f,3.700088873f,3.698854355f,3.691865134f,3.689648931f,3.668336968f,3.642854086f,3.641954579f,3.638168135f,3.633005375f,3.627717446f,3.622379804f,3.617496356f,3.609295835f,3.602875525f,3.60089382f,3.589128301f,3.585029044f,3.572944614f,3.570110664f,3.56824108f,3.565315393f,3.562651171f,3.559820267f,3.559019211f,3.55745927f,3.551855664f,3.548806136f,3.547281147f,3.540095557f,3.537998147f,3.530528187f,3.526926708f,3.504090861f,3.502720761f,3.500413032f,3.495289236f,3.493958555f,3.486800388f,3.469998822f,3.468430692f,3.457805506f,3.424832088f,3.42385411f,3.423647583f,3.42177365f,3.400421457f,3.393910935f,3.389127749f,3.387033055f,3.384638966f,3.379284735f,3.379276327f,3.375289136f,3.373660093f,3.37341306f,3.354100879f,3.353451208f,3.349825327f,3.338294843f,3.328386389f,3.31830623f,3.313190599f,3.302639028f,3.297374339f,3.286496479f,3.278997953f,3.273923936f,3.273586175f,3.26529613f,3.265090953f,3.261966984f,3.248699235f,3.245544245f,3.228321595f,3.219037719f,3.218996206f,3.212632366f,3.211549274f,3.193743528f,3.186751001f,3.186659652f,3.17415127f,3.172602768f,3.165453397f,3.159574558f,3.157946687f,3.14810017f,3.143399853f,3.137114454f,3.136656857f,3.132169968f,3.131450783f,3.118336386f,3.116848174f,3.11650673f,3.114037344f,3.112058487f,3.111724902f,3.110510218f,3.105105711f,3.098592684f,3.093113017f,3.091474759f,3.08276699f,3.082754841f,3.081882779f,3.07655175f,3.070622247f,3.063296048f,3.046479463f,3.036083334f,3.033858869f,3.031622104f,3.03072677f,3.019434708f,3.017746905f,3.013830931f,3.01188822f,3.010521392f,3.006769278f,2.997770861f,2.997188095f,2.992436938f,2.988098326f,2.979403564f,2.972856138f,2.97189457f,2.950653448f,2.943426315f,2.938090092f,2.934614153f,2.933452694f,2.915465468f,2.911321887f,2.906009028f,2.90355912f,2.897863393f,2.891750551f,2.878555154f,2.875594001f,2.872824257f,2.867631294f,2.867200961f,2.859938402f,2.855727926f,2.84843814f,2.847910458f,2.844113097f,2.841165501f,2.829369137f,2.828677997f,2.814258458f,2.813365671f,2.805102313f,2.799545392f,2.797128234f,2.795421413f,2.778200689f,2.774947006f,2.768036081f,2.764155495f,2.759670256f,2.756895551f,2.756040604f,2.753861316f,2.751852541f,2.745432421f,2.745423705f,2.736486421f,2.733548253f,2.727615496f,2.725942138f,2.725361866f,2.710867574f,2.705608409f,2.699683173f,2.696171123f,2.694849795f,2.686666783f,2.684148183f,2.675871072f,2.673413603f,2.673362258f,2.670318971f,2.665790175f,2.660644852f,2.655948211f,2.652064696f,2.648997601f,2.641684478f,2.632566239f,2.628534366f,2.614494391f,2.612420977f,2.601568729f,2.601280946f,2.59794212f,2.588789756f,2.584926156f,2.583674423f,2.581779745f,2.566922262f,2.546982351f,2.544409992f,2.542302687f,2.541689325f,2.535285623f,2.531526604f,2.524428804f,2.516597968f,2.515480688f,2.504822976f,2.493362224f,2.487426339f,2.482353522f,2.480527138f,2.480044901f,2.473900281f,2.471131664f,2.464567748f,2.458372985f,2.456337022f,2.444344198f,2.443372204f,2.433662155f,2.424957462f,2.424895558f,2.422914112f,2.418633616f,2.413719972f,2.405243057f,2.400403485f,2.397401342f,2.395819079f,2.391010959f,2.382013362f,2.377460512f,2.376439697f,2.373608794f,2.366930919f,2.363742739f,2.355986668f,2.350009183f,2.335922179f,2.32239309f,2.322305897f,2.321040901f,2.316739133f,2.311943621f,2.298905198f,2.292992841f,2.284291988f,2.278583113f,2.261967362f,2.261736483f,2.260598831f,2.249834469f,2.248925796f,2.241483449f,2.237914372f,2.237456912f,2.233647003f,2.232197601f,2.230091872f,2.217077199f,2.207909828f,2.200431348f,2.199484363f,2.197882765f,2.195699079f,2.190887521f,2.187762909f,2.18030214f,2.179319529f,2.179089631f,2.17612538f,2.171737357f,2.170338054f,2.166048679f,2.160660023f,2.155581256f,2.146464841f,2.141113661f,2.136865443f,2.133981863f,2.126595981f,2.120739001f,2.109785404f,2.106406579f,2.103068363f,2.100216635f,2.086184824f,2.085729071f,2.084693483f,2.084593307f,2.083475841f,2.081757739f,2.079244016f,2.078356835f,2.070846955f,2.067268727f,2.061617623f,2.056208909f,2.052379081f,2.043915366f,2.036932187f,2.02536856f,2.022049361f,2.019964716f,2.013158726f,2.010291044f,1.997794075f,1.994601353f,1.993874162f,1.99379179f,1.993504789f,1.993288302f,1.991812126f,1.984552615f,1.981619678f,1.981423174f,1.97881256f,1.973678555f,1.972218216f,1.969448463f,1.96830061f,1.958474892f,1.940836892f,1.937834978f,1.936845797f,1.936840764f,1.932290269f,1.930923486f,1.919760124f,1.918454617f,1.917651741f,1.912565363f,1.903551194f,1.901418953f,1.896969514f,1.896297685f,1.894271871f,1.892659245f,1.880103012f,1.879126063f,1.878174417f,1.862106208f,1.84562149f,1.843533976f,1.839536565f,1.834802075f,1.825192724f,1.824102491f,1.821576746f,1.819909061f,1.815917699f,1.813659666f,1.812974234f,1.810845021f,1.808445355f,1.807396335f,1.79142946f,1.783236482f,1.782111238f,1.776507418f,1.765271443f,1.759211172f,1.757878646f,1.757577375f,1.747929589f,1.744614347f,1.740045332f,1.735788669f,1.73286232f,1.732077691f,1.726403557f,1.718645231f,1.711910782f,1.707881586f,1.706447116f,1.706043164f,1.70156363f,1.696966735f,1.696014575f,1.694652479f,1.692905134f,1.692518407f,1.691612874f,1.690968881f,1.68912916f,1.687557781f,1.67490341f,1.65814008f,1.655673016f,1.65235358f,1.648523271f,1.648025093f,1.647782685f,1.64374891f,1.635996863f,1.634048684f,1.626582148f,1.624704608f,1.623956372f,1.615350737f,1.610788427f,1.604020193f,1.598357857f,1.594267011f,1.582742935f,1.581051804f,1.579049312f,1.576285351f,1.569371747f,1.567629975f,1.559266225f,1.553584802f,1.55286271f,1.55254273f,1.54768079f,1.545912157f,1.536286431f,1.520105567f,1.510825222f,1.50716346f,1.506566462f,1.506278311f,1.503041898f,1.5002022f,1.500067052f,1.498570115f,1.495565734f,1.487847584f,1.479635467f,1.476061731f,1.470369134f,1.46677452f,1.466046514f,1.460932666f,1.454763315f,1.453954191f,1.453726824f,1.450216384f,1.436857048f,1.436444073f,1.434261345f,1.423651388f,1.419785961f,1.418584012f,1.416630882f,1.410769285f,1.409899031f,1.403781681f,1.397979959f,1.397452936f,1.39332202f,1.385502899f,1.382062939f,1.377202314f,1.374019535f,1.365409063f,1.361440686f,1.359925085f,1.359645462f,1.353491915f,1.351234167f,1.350717306f,1.350358863f,1.347198114f,1.338863873f,1.336425111f,1.332406343f,1.306409975f,1.304010382f,1.303958104f,1.303815187f,1.303690387f,1.297079764f,1.295123168f,1.293231298f,1.292699815f,1.291451682f,1.290687021f,1.288413199f,1.285502299f,1.285057635f,1.274198736f,1.271934245f,1.271160108f,1.269661847f,1.263824433f,1.263175159f,1.262018546f,1.258365235f,1.257505457f,1.254099368f,1.253248594f,1.251878207f,1.243247581f,1.239208926f,1.239033667f,1.236858286f,1.233528739f,1.230114829f,1.227010249f,1.226403101f,1.220821714f,1.21564392f,1.214156215f,1.210754355f,1.208873644f,1.20272911f,1.196737f,1.193971952f,1.190484585f,1.181727127f,1.181140709f,1.176428849f,1.172711634f,1.168647381f,1.16807207f,1.161570252f,1.152293067f,1.150009214f,1.147785238f,1.142393803f,1.135824683f,1.1347866f,1.122350752f,1.113167834f,1.098447957f,1.090857974f,1.086725087f,1.081418557f,1.081066074f,1.080110894f,1.078432416f,1.072752095f,1.068184669f,1.058707619f,1.045680832f,1.035294566f,1.033132942f,1.027321429f,1.02607214f,1.024747278f,1.02301777f,1.022251436f,1.019267207f,1.018705243f,1.018084865f,1.003121517f,1.002978491f,1.002776856f,1.002454035f,1.000511829f,0.999990844f,0.994109374f,0.991800568f,0.990679172f,0.988669583f,0.988512666f,0.985619164f,0.984820495f,0.982764849f,0.979611625f,0.968769554f,0.960750876f,0.953222009f,0.948553363f,0.946255667f,0.942824915f,0.942426893f,0.932149818f,0.930673529f,0.92552135f,0.922719267f,0.919957563f,0.916797711f,0.91641968f,0.915924041f,0.911150943f,0.906322644f,0.898078106f,0.89705464f,0.896007415f,0.894735795f,0.894069455f,0.880132235f,0.879807861f,0.872995775f,0.870680444f,0.86970331f,0.867012659f,0.865525967f,0.864085661f,0.863835567f,0.861260319f,0.857154622f,0.855810037f,0.854186476f,0.852462878f,0.849516222f,0.847560944f,0.846289162f,0.838918962f,0.831703396f,0.829522901f,0.829103126f,0.822854208f,0.821864979f,0.816869141f,0.810527014f,0.809006524f,0.805959932f,0.804480088f,0.801687327f,0.799680054f,0.796989163f,0.78892659f,0.785004228f,0.782111317f,0.77709777f,0.770398023f,0.76943455f,0.768575512f,0.765470993f,0.756849812f,0.751990805f,0.749564206f,0.748159224f,0.745637227f,0.742510967f,0.739583354f,0.726106653f,0.724501633f,0.711312478f,0.71112648f,0.701911404f,0.696182818f,0.694092071f,0.692117508f,0.679934912f,0.679507848f,0.677177565f,0.668868474f,0.652981328f,0.652292096f,0.646963619f,0.644509225f,0.643886491f,0.640932374f,0.637097973f,0.63521187f,0.634085491f,0.626756914f,0.621761171f,0.620586199f,0.620505122f,0.607176228f,0.606592962f,0.603377366f,0.595604662f,0.594822407f,0.588005615f,0.582822029f,0.577167276f,0.571189282f,0.570239629f,0.569264072f,0.552657829f,0.551904419f,0.548984157f,0.548516971f,0.548502692f,0.548206435f,0.547669721f,0.545889795f,0.545513173f,0.542717471f,0.541030853f,0.539699934f,0.537654956f,0.529522949f,0.527456858f,0.514649732f,0.513080571f,0.510947326f,0.510929204f,0.503333876f,0.500342771f,0.493745609f,0.485579942f,0.484957669f,0.484718463f,0.484198722f,0.478919121f,0.473566834f,0.472785996f,0.467469714f,0.466196993f,0.462039183f,0.456551488f,0.455073698f,0.453718093f,0.448631824f,0.444719185f,0.443518854f,0.435865872f,0.432216176f,0.427171827f,0.42514648f,0.416889921f,0.413379234f,0.409672943f,0.401772986f,0.398710552f,0.397437809f,0.396760778f,0.395747636f,0.388919956f,0.386226291f,0.385602441f,0.385500126f,0.381680387f,0.380666547f,0.376903092f,0.375579189f,0.373816543f,0.373636317f,0.369876115f,0.367573417f,0.36755511f,0.366342072f,0.365127599f,0.364120927f,0.361651311f,0.356398447f,0.353662178f,0.351845436f,0.347616622f,0.343310049f,0.343248754f,0.342789708f,0.339777286f,0.337334007f,0.337152013f,0.336255738f,0.326572008f,0.325864119f,0.318311473f,0.31265538f,0.310506626f,0.309644036f,0.306246572f,0.299482911f,0.294774906f,0.290156462f,0.286558731f,0.285655761f,0.279532245f,0.269269506f,0.262302739f,0.25929936f,0.258198493f,0.255649577f,0.25222479f,0.250712067f,0.248272129f,0.24563407f,0.24393174f,0.242716201f,0.237818225f,0.236493368f,0.21676266f,0.214694593f,0.213975787f,0.213288624f,0.204213662f,0.203564372f,0.20182173f,0.201790928f,0.198803577f,0.195524325f,0.190771422f,0.187620203f,0.181225022f,0.181145601f,0.180950316f,0.180317143f,0.176496798f,0.166578047f,0.166392789f,0.161263045f,0.159604147f,0.157141097f,0.155814496f,0.155287128f,0.153707597f,0.150514707f,0.146635118f,0.145952459f,0.143910769f,0.142593152f,0.141895249f,0.140736113f,0.139039821f,0.138657678f,0.135614115f,0.131901924f,0.124243664f,0.122944885f,0.119929387f,0.11961341f,0.11701032f,0.112167329f,0.109650393f,0.101255133f,0.087507057f,0.085933718f,0.08343779f,0.080273826f,0.07407204f,0.068395663f,0.061931735f,0.057183945f,0.05552247f,0.044566585f,0.044284632f,0.041456263f,0.039161268f,0.033767439f,0.032026658f,0.030823364f,0.02983295f,0.029153046f,0.028254715f,0.026927378f,0.026751615f,0.025626364f,0.022755792f,0.021446326f,0.019633151f,0.014426916f,0.013947263f,0.01071419f,0.009032278f,0.008845311f,0.005626059f,0.000494107f,0.000487678f,0.000285141f)
    val isDecoy = Array(false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,true,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,true,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,true,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,true,false,false,false,true,false,false,false,false,false,true,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,true,false,false,false,false,false,true,false,false,false,true,false,false,false,false,false,false,true,false,true,true,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,true,false,false,true,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,true,false,false,true,false,false,true,true,false,true,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,true,false,false,false,false,false,false,false,false,false,true,false,true,false,false,false,false,true,true,false,false,true,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,true,true,true,false,true,false,false,false,false,false,false,false,true,false,false,false,false,true,false,false,false,true,false,false,false,false,false,false,false,false,false,true,false,false,false,true,false,false,false,false,false,false,true,false,false,false,true,true,false,true,false,false,false,false,false,true,true,false,false,false,true,true,true,false,true,false,false,false,false,false,true,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,true,true,false,true,false,false,false,false,true,false,false,true,false,false,false,false,false,false,false,false,true,false,false,false,true,false,false,false,false,false,true,true,true,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,true,true,false,false,true,true,false,false,true,true,false,false,false,false,false,true,false,false,false,false,false,false,true,false,true,false,true,true,false,false,true,false,false,false,false,false,false,true,false,false,false,true,false,false,false,false,true,true,false,false,true,false,false,true,false,false,false,false,true,false,true,false,true,true,false,false,false,true,false,true,false,false,true,false,true,true,false,true,false,false,false,false,true,true,false,false,false,true,true,true,false,false,false,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,true,true,false,true,false,true,false,true,false,true,true,false,false,true,false,false,false,true,false,true,true,true,true,false,false,false,false,false,false,true,true,false,false,true,false,true,true,false,false,false,false,true,false,false,false,false,true,false,false,false,true,false,false,false,false,false,true,false,false,true,false,true,false,false,false,true,true,false,false,false,true,false,true,false,true,true,true,true,true,true,true,false,true,false,false,false,true,true,true,true,true,false,true,false,true,true,true,true,true,true,true,true,false,true,false,true,false,false,true,false,false,false,true,true,true,false,true,true,false,false,true,false,false,true,true,true,true,true,false,true,true,false,true,true,true,true,true,true,false,true,false,false,false,false,true,false,true,true,true,false,false,true,false,false,false,false,true,true,true,false,false,true,true,true,false,true,false,true,true,true,true,true,true,true,true,false,true,false,true,true,true,true,true,true,true,false,true,true,true,true,true,false,true,true,true,false,true,true,true,true,true,true,true,true,true,false,true,true,false,true,true,true,true,true,true,true,true,true,false,false,false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,true,true,true,true,false,true,true,true,false,true,true,true,false,false,true,true,true,false,false,true,true,true,true,true,true,true,true,true,false,true,true,true,false,true,true,true,true,false,false,true,true,false,true,true,true,true,true,false,true,true,true,true,true,true,true,true,true,true,true,true,true,false,true,true,true,true,false,true,true,true,false,true,false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,true,true,true,true,true,true,true,true,false,true,true,true,true,true,true,true,false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,true,true,true,true,true,true,true,true,true,true,false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,true,true,true,true,true,true,false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,true,true,true,true,true,true,true,true,false,true,false,true,true,true,true,false,true,true,true,false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true)

    val psm = for (i <- 0 to 2999) yield _buildPeptideMatch(i, scores(i), isDecoy(i))

    val targetPSM = psm.filter(!_.isDecoy)
    val decoyPSM = psm.filter(_.isDecoy)

    val tdAnalyzer = new BasicTDAnalyzer(TargetDecoyComputer.calcCdFDR)
    val rocPoints = tdAnalyzer.performROCAnalysis(targetPSM, decoyPSM , new ScorePSMFilter())//.sortBy(_.fdr)
//    for (i <- 0 to 999) {
//      val p = rocPoints(i)
//      println("basic ; " + p.targetMatchesCount + ";" + p.decoyMatchesCount.get + ";" + p.fdr.get)
//    }
//
//    println("############")
    // restore validation status (not sure that this is mandatory ?)
    psm.foreach { pm => pm.isValidated = true }

    val gtdAnalyzer = new GorshkovTDAnalyzer()
    val gRocPoints = gtdAnalyzer.performROCAnalysis(targetPSM, decoyPSM , new ScorePSMFilter())//.sortBy(_.fdr)
    for (i <- 0 to 999) {
      val p = gRocPoints(i)
      println("gorshkov ; " + p.targetMatchesCount + ";" + p.decoyMatchesCount.get + ";" + p.fdr.get)
    }

    ()
  }

  @Test
  def adjustP() = {
    val pValue = Array(0.027213734, 0.002130990, 0.008984681, 0.011239151, 0.001358925, 0.003836214, 0.000345691, 0.078700302, 0.042893526, 0.000472456f)
    val adjustedPValues = BHFilter.adjustPValues(pValue)
    for (i <- 0 to pValue.length-1) {
      println(pValue(i) + ";" + adjustedPValues(i))
    }
  }


  def _buildPeptideMatch(id: Long, score: Float, isDecoy: Boolean): PeptideMatch = {
      new PeptideMatch(id = id, rank = 1, score = score, scoreType = PeptideMatchScoreType.MASCOT_IONS_SCORE, charge = 2, deltaMoz = 0.0001f, isDecoy = isDecoy, peptide = fakePeptide)
  }



  @Test
  def rocPointsFilter() = {
    val rocPoints = Array(new ValidationResult(1, Some(0), Some(TargetDecoyComputer.calcCdFDR(1,0))),
                          new ValidationResult(2, Some(0), Some(TargetDecoyComputer.calcCdFDR(2,0))),
                          new ValidationResult(2, Some(1), Some(TargetDecoyComputer.calcCdFDR(2,1))),
                          new ValidationResult(3, Some(1), Some(TargetDecoyComputer.calcCdFDR(3,1))),
                          new ValidationResult(3, Some(2), Some(TargetDecoyComputer.calcCdFDR(3,2))),
                          new ValidationResult(3, Some(3), Some(TargetDecoyComputer.calcCdFDR(3,3))),
                          new ValidationResult(3, Some(4), Some(TargetDecoyComputer.calcCdFDR(3,4))),
                          new ValidationResult(4, Some(4), Some(TargetDecoyComputer.calcCdFDR(4,4))),
                          new ValidationResult(5, Some(4), Some(TargetDecoyComputer.calcCdFDR(5,4))),
                          new ValidationResult(6, Some(4), Some(TargetDecoyComputer.calcCdFDR(6,4))),
                          new ValidationResult(6, Some(5), Some(TargetDecoyComputer.calcCdFDR(6,5))),
                          new ValidationResult(6, Some(6), Some(TargetDecoyComputer.calcCdFDR(6,6)))
    )

    rocPoints.foreach(println(_))

    val filteredRocPoints = RocPointsFilter.byTargetDecoyEdges(rocPoints)
    val l = filteredRocPoints.length
    println("---------------------")
    filteredRocPoints.foreach(println(_))
    ()
  }

  @Test(expected = classOf[IllegalArgumentException])
  def getBasicTDAnalyzerWoSSProperties() = {

    val tdAnalyzer = new TDAnalyzerBuilder(analyzer = TargetDecoyAnalyzers.BASIC).build(Some(rs))
  }

  @Test
  def getCorrectBasicTDAnalyzerWSorter() = {
    val prop = new ResultSetProperties()
    prop.targetDecoyMode = Some("SEPARATED")
    rs.properties = Some(prop)

    val sorter: IPeptideMatchSorter = new ScorePSMFilter()
    val tdAnalyzer = new TDAnalyzerBuilder(analyzer = TargetDecoyAnalyzers.BASIC).build(Some(rs))
    assertNotNull(tdAnalyzer)
    assertTrue(tdAnalyzer.isDefined)
    assertTrue(tdAnalyzer.get.isInstanceOf[BasicTDAnalyzer])

    val validator = new TDPepMatchValidatorWithFDROptimization(new ScorePSMFilter(), Some(0.01f))
    validator.validatePeptideMatches(rs, tdAnalyzer)

    ()
  }

  // FIXME: re-enable test when  ComputedTDAnalyzer is fixed
  @Ignore
  def getCorrectComputedTDAnalyzerWSorter() = {

    val sorter: IPeptideMatchSorter = new ScorePSMFilter()
    val tdAnalyzer = new TDAnalyzerBuilder(analyzer = TargetDecoyAnalyzers.BASIC).build(Some(rs))
    assertNotNull(tdAnalyzer)
    assertTrue(tdAnalyzer.isDefined)
    // FIXME: remove this comment when ComputedTDAnalyzer is fixed
    //assertTrue(tdAnalyzer.get.isInstanceOf[CompetitionBasedTDAnalyzer])
  }
}

